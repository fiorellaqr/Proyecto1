<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css" />
    <link rel="icon" href="img/Logo.png" />
    <link rel="stylesheet" href="css/checkout.css" />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@200;300;400&display=swap" rel="stylesheet" />
    <script src="https://kit.fontawesome.com/638ca44e0a.js" crossorigin="anonymous"></script>
    <title>Checkout</title>
</head>

<body>

    <div class="fijar">
        <div class="menu">
            <input type="checkbox" id="btn-menu">
            <label for="btn-menu"><i class="fa-solid fa-bars"></i></label>
            <h1><a href="index.html">MiTienda</a></h1>
            <div class="menu-item">
                <div class="item-catalogo">
                    <p><b>Catalogo</b></p>
                    <ul>
                        <li><a href="hombres.html">Varones</a></li>
                        <li><a href="mujeres.html">Damas</a></li>
                        <li><a href="NiÃ±os.html">Infantes</a></li>
                    </ul>
                </div>
                <p>
                    <b><a href="Login.html">Login</a></b>
                </p>
                <p>
                    <b><a href="carrito.html"><i class="fa-solid fa-cart-shopping"></i></a></b>
                </p>
            </div>
        </div>
    </div>

    <div style="padding-top: 8%">
        <div class="content row" id="cuerpo">

            <div class="col-8 col-md-8 col-sm-10">
                <h4><b>Elige un tipo de entrega</b> </h4>
                <div class="accordion" id="accordionExample">
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="headingOne">
                            <button class="accordion-button" type="button" data-bs-toggle="collapse"
                                data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                                <div class="row col-12 col-md-12 ">
                                    <div class="col-1 col-md-1 col-sm-2">
                                        <i class="fa-solid fa-shop"></i>
                                    </div>
                                    <div class="col-9 col-md-9 col-sm-8">
                                        <p class="titulo">Retira en tienda </p>
                                        <p class="subtitulo">Elige tu local de retiro</p>
                                    </div>
                                    <div class="col-2 col-md-2 col-sm-2">
                                        <p>Gratis</p>
                                    </div>

                                </div>

                            </button>
                        </h2>
                        <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne"
                            data-bs-parent="#accordionExample">
                            <div class="accordion-body">
                                <div class="row  justify-content-center">
                                    <div class="col col-5 col-sm-5 col-md-5">
                                        Tiendas de Recojo
                                    </div>
                                    <div id="divTiendas" class="col col-5 col-sm-5 col-md-5">
                                        <select id="selTiendas" class="form-control">
                                            <option>Tienda Miraflores</option>
                                            <option>Tienda Los Olivos</option>
                                            <option>Tienda Surco</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="headingTwo">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                                <div class="row col-12 col-md-12 ">
                                    <div class="col-1 col-md-1 col-sm-2">
                                        <i class="fa-solid fa-truck"></i>
                                    </div>
                                    <div class="col-9 col-md-9 col-sm-8">
                                        <p class="titulo">Envio a domicilio</p>
                                        <p class="subtitulo">Ingresa tu direccion</p>
                                    </div>
                                    <div class="col-2 col-md-2 col-sm-2">
                                        <p>S/10.00</p>
                                    </div>

                                </div>

                            </button>
                        </h2>
                        <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo"
                            data-bs-parent="#accordionExample">
                            <div class="accordion-body">
                                <div class="row  justify-content-center">
                                    <div class="col col-5 col-sm-5 col-md-5">
                                        Direccion
                                    </div>
                                    <div id="divTiendas" class="col col-5 col-sm-5 col-md-5">
                                        <input type="text" id="" class="form-control">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>

            </div>

            <div class="col-3 col-md-3 col-sm-11">
                <div class="card">
                    <h5 class="card-header">Resumen de Pago</h5>
                    <div class="card-body row">
                        <div class="col col-6">
                            <p class="card-text">Productos (<span id="cprod"></span>):</p>
                        </div>
                        <div class="col col-6">
                            <p>S/. <span id="subtotal"></span></p>
                        </div>
                        <div class="col col-6">
                            <p class="card-text">Envio:</p>
                        </div>
                        <div class="col col-6">
                            <p>S/. <span id="penvio">0.00</span></p>
                        </div>
                        <div class="col col-6">
                            <p class="card-text">Total:</p>
                        </div>
                        <div class="col col-6">
                            <p>S/. <span id="total"></span> </p>
                        </div>

                        <a href="checkout.html" class="btn btn-primary col col-11 mx-auto">Procesar compra</a>
                    </div>
                </div>
            </div>


        </div>
    </div>

    <script src="bootstrap/js/bootstrap.min.js"></script>
    <script src="bootstrap/js/jquery.js"></script>
    <script>

        function calcularPrecioEnvio() {
            document.querySelectorAll('.accordion-item').forEach(elemento => {
                elemento.onclick = () => {
                    console.log("click");
                    idSeleccionado=elemento.getElementsByTagName("h2")[0].id;

                    if (idSeleccionado=="headingOne") {
                        var penvio=0;
                        $("#penvio").text(penvio.toFixed(2));
                        calcularTotal();
                        return penvio;
                    }
                    if (idSeleccionado=="headingTwo") {
                        var penvio=10;
                        $("#penvio").text(penvio.toFixed(2));
                        calcularTotal();
                        return penvio;
                    }

                }
            });
        }


        function calcularTotal(){
            miCarrito=JSON.parse(localStorage.getItem("miCarrito"));
            listaProductos=JSON.parse(localStorage.getItem("lista_prod"));

            var subtotal=0;
            var total=0;
            miCarrito.forEach((itemCarr,index)=>{
                producto = listaProductos[itemCarr.id - 1];
                subtotal += producto.precio * itemCarr.cantidad;
                
            });

            total=subtotal+penvio;

            
            //ppenvio=$("#penvio").innerHTML;
            total=subtotal+parseInt(penvio.innerHTML);
            console.log(penvio.innerHTML);
            console.log(total);
            $("#subtotal").text(subtotal.toFixed(2));
            $("#total").text(total.toFixed(2));
            $("#cprod").text(miCarrito.length);
        }

        calcularPrecioEnvio();
       calcularTotal();
    </script>
</body>

</html>